# 迁移学习

我们已经知道CNN由多个层级组成，作为深度学习专业人士，我们设计了这一架构，包括设置很多超参数，例如窗口大小，stride和填充，设置架构后，我们选择损失函数和优化程序，然后设置训练模型并等待

对于这些已经深入学会如何从图片中寻找规律的CNN架构，如何调整这些CNN以用到我们自己的分类任务中，我们如何不用从头构建一个CNN，而是运用所学的知识并传递给新的深度学习模型？我们可以通过一种叫做迁移学习的技巧顺利实现这一目标

但你可以会有疑问，如果你用这个在ImageNet数据库上经过训练的CNN，该CNN已经学会区分ImageNet中存在的1000种不同类别的图片，大部分类别都是动物、水果、植物或日常物品，现在假设你感兴趣的图片数据库与这些图片类没有重叠，依然能够使用这个提前训练好的CNN吗？甚至于新的任务有关联吗？答案是绝对肯定的。训练好的CNN中的卷积过滤器按层级排列，第一层级中的过滤器通常用于检测边缘或色块，第二层级可能会检测圆圈、条纹和长方形，这些依然是很普通的特征，可以用来分析任何数据集中的任何图片，最后卷积层中的过滤器更加具体化，如果训练数据集中有鸟类，则有可能检测鸟类的过滤器，如果有汽车或自行车，则有可以检测轮子的过滤器，我们发现，可以删掉网路中最后几个，非常特定于训练数据集的层级，同时保留之前的层级，然后我们可以添加一两个层级，仅训练最后的层级

这是一种迁移学习技巧，但是你的方法将取决于数据集的大小以及与ImageNet数据库的相似程度
例如，如果你的数据集相对较小并且与ImageNet非常相似，那么我们刚刚提到的技巧效果会很好，顺便提下Sebastian Thrun与斯坦福大学团队，最近利用迁移学习开发了一个诊断皮肤癌的CNN，该CNN可以将病灶分类为良性或恶性，并且在诊断某些类型的皮肤癌方面，取得的效果比皮肤科医生要高，为了构建他的这一模型，他使用了迁移学习方法，并利用在ImageNet数据库上训练好的Inception架构

首先，他删掉了最后的密集连接分类层，并添加了新的完全连接层，这一层级的类别少了很多，每个都是他想检测的疾病类别，对于该网络中的所有其他层级，参数都使用提前训练的值初始化，在训练过程中，对这些参数进一步优化，以便拟合皮肤病灶数据库，该模型通过利用在ImageNet上提前训练好的神经网络有了很好的开端受益很多，如果你的数据集非常大，并且与ImageNet数据库差别很大，那么这种具有不同的最后分类层级并且细调网络参数的方法效果最好
