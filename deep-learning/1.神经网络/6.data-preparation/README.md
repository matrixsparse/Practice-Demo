# data preparation

要从神经网络中获得好的结果，一定要清理和转换数据

```bash
数据是神圣的，每天的每个小时，就有一个新的传感器连接到网络

每一趟旅程、每一个记忆、每一次创作、每次发现都进入到这一由我们共同构建的不断壮大的网络中来

数据它是透明的，可证明的，大部分数据是一堆松散的原始数字流，以令人眼花缭乱的速度

不断聚集，但是通过对数据应用智能处理，我们便可找到

真正重要的内在模式和连接方式，我们可以解读隐藏在数字背后的意义

在经济学家的眼中，你得到的越多，我得到的就越少

但对于相爱的人来说，你得到的越多，我得到的也越多

当我们将合适的数据进行可视化时，会感受到艺术与科学的完美交汇，就像奇迹一样

如何预处理数据集

准备数据是机器学习中最为重要的部分

一旦你想清楚了想要解决什么问题，或要找到什么问题的答案

接下来要做的就是找到合适的数据集

你的深度网络能做出多好的预测，取决于你给它的数据质量有多高

进行的是垃圾，出来的也将是垃圾

所以要确保你的数据与你的问题相关

有大量的资源可以帮你找到公开可用的数据集

我在说明部分提供了一些链接

数据的实际标准格式

为CSV大多数软件包都能处理此格式的数据

你可以轻松地将数据转换为CSV格式

我们可以对数据执行的操作很多

对于每个数据集，都有三个预处理核心步骤

清理、转换和缩减

我们将看三个不同的数据集，对每个数据集，都执行这三步，以供后续的模型训练所用
```

```bash
第一个数据集与音乐有关

该数据集是收集自一个名为"标记音调"(Tag A Tune)的游戏中

在游戏中，两名玩家要听同一首歌曲

然后添加他们认为与该曲相关的歌曲或乐器标签

当歌曲放完时，正确标签较多的玩家得一分

我们的数据集有25000首歌，都带有正确标记的标签

要基于这些数据，训练一个模型，让它能在给一首新歌时，将其正确分类

我们将导入pandas来帮助我们解析这个数据集

然后用read csv函数帮助我们将数据存储在二维的pandas数据结构中，也称为数据框

数据框很容易修改，我们将变量命名为newdata

使用head函数来显示前五行，将5作为参数

基本上，每一行都有一个编号

具有ID并且在标签旁用1或0来表示所给的歌曲是否带有该标签

可以使用info函数获得更多数据

每个标签都有一个简明的二进制标签

数据具有一致性，而且幸运的是，没有数据是空值

能对数据进行哪些改进？使模型更容易理解它呢？

为数据中的同义词创建一个二维列表

可以合并同义词，仅保留第一列，删除其他列

对于矩阵中的每个同义词列表，取每个特征的最大值 都将它们加到

数据对象的第一个同义词中，这将有效地将值合并为一列

然后从数据框中删除其余的重复特征

现在有了更泛化的特征

将它们放入模型的训练、验证和测试集中

需要自己挑选合适的特征来训练模型

深度神经网络能从我们提供的特征中学习高级特征

它可以自己决定数据集中哪些数据与问题有关

结构工程是新的特征工程

# import libraries
import pandas as pd

# read
newdata = pd.read.csv('annotations_final.csv','sep=\t')

# display the top 5 rows
newdata.head(5)

newdata.info()

for synonym_list in synonyms:
  newdata[synonym_list[0]] = newdata[synonym_list].max(axis=1)
  newdata.drop(synonym_list[1:],axis=1,inplace=True)

training_set = newdata[:19773]
validation_set = newdata[19773:21]
```

第二个数据集是网络连接的集合

有两种标记：正常或异常

异常连接是试图闯入的入侵者

在给定一些其他特征的情况下对连接进行分类

应该将它们归一化，以使得模型平等对待每个特征
